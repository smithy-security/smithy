name: mobsfscan
description: "Static analysis tool that can find insecure code patterns in your Android and iOS source code. Supports Java, Kotlin, Android XML, Swift and Objective C Code. Mobsfscan uses MobSF static analysis rules and is powered by semgrep and libsast pattern matcher."
type: scanner
steps:
  - name: run-mobsfscan
    image: opensecurity/mobsfscan:latest
    executable: /usr/local/bin/mobsfscan
    args:
    - --sarif
    - --no-fail
    - --output={{ scratchWorkspace }}/mobsfscan.json
    - "{{ sourceCodeWorkspace }}"
  - name: parser
    image: components/scanners/mobsfscan
    env_vars:
      MOBSF_RAW_OUT_FILE_PATH: "{{ scratchWorkspace }}/mobsfscan.json"
    executable: /bin/app
