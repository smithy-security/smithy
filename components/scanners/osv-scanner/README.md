# osv-scanner

This component implements a [scanner](https://github.com/smithy-security/smithy/blob/main/sdk/component/component.go)
that invokes [osv-scan](https://google.github.io/osv-scanner/) for all modules in the repository and adds information
in the output related to the lines where each vulnerable dependency discovered is located to assist the reviewing
process. The results generated will be in [ocsf](https://github.com/ocsf) format.

The module discovery is not left to the OSV scanner itself but it is implemented by us so that we can add more
intelligence. When a repository is scanned, if there is no git diff available, we will search for modules of supported
languages and pass them to the scanner. If a module is identified the scanner will not look further down the filesystem
tree. If a git diff is available, it will be loaded and we will look in it for modifications to dependency files of
supported languages.

Supporting a language means that we can get the results from the OSV scanner and add information about which line of
the dependency file they are declared.

## Supported Languages

1. Golang
2. JavaScript/TypeScript
3. Elixir

## Environment variables

The component uses environment variables for configuration.

It requires the component
environment variables defined [here](https://github.com/smithy-security/smithy/blob/main/sdk/README.md#component) as well
as the following:

| Environment Variable     | Type   | Required | Default    | Description                                             |
|--------------------------|--------|----------|------------|---------------------------------------------------------|
| WORKSPACE\_PATH          | string | yes      | .          | The path where root of the repository is located        |
| GIT\_RAW\_DIFF\_PATH     | string | no       | -          | The path of the git diff file                           |

## Test data

The `raw-results.json` files used in the internal/transformer tests were generated by running the OSV scanner for well
known vulnerable repositories.
